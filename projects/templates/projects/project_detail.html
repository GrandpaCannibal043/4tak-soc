{% extends "projects/base.html" %}

{% block title %}{{ project.title }}{% endblock %}

{% block content %}

<div class="card p-4">

    <!-- üñºÔ∏è OBR√ÅZOK PROJEKTU -->
    {% if project.image %}
        <img src="{{ project.image.url }}"
             alt="{{ project.title }}"
             style="
                width: 100%;
                max-height: 360px;
                object-fit: cover;
                border-radius: 14px;
                margin-bottom: 25px;
             ">
    {% endif %}

    <!-- N√ÅZOV -->
    <h1>{{ project.title }}</h1>

    <!-- POPIS -->
    <p class="text-muted">
        {{ project.functionality }}
    </p>

    <!-- BADGES -->
    <div class="mb-3">
        <span class="badge bg-primary">
            {{ project.get_project_type_display }}
        </span>
        <span class="badge bg-secondary">
            N√°roƒçnos≈• {{ project.difficulty }}/5
        </span>
    </div>

    <hr>

    <!-- PRIEMERN√â HODNOTENIE -->
    <p>
        <strong>Priemern√© hodnotenie:</strong>
        {% if average_rating %}
            {{ average_rating|floatformat:1 }}/5
        {% else %}
            zatiaƒæ nehodnoten√©
        {% endif %}
    </p>

    <hr>

    <!-- FORMUL√ÅR NA HODNOTENIE -->
    {% if user.is_authenticated %}
        <form method="post" class="mb-3">
            {% csrf_token %}

            <label for="rating"><strong>Tvoje hodnotenie:</strong></label>

            <select name="rating"
                    id="rating"
                    class="form-select w-auto d-inline-block ms-2">
                {% for i in "12345" %}
                    <option value="{{ i }}"
                        {% if user_rating and user_rating.value == i|add:"0" %}
                            selected
                        {% endif %}>
                        {{ i }}
                    </option>
                {% endfor %}
            </select>

            <button type="submit" class="btn btn-primary ms-2">
                Ulo≈æi≈•
            </button>
        </form>
    {% else %}
        <p class="text-muted">
            Pre hodnotenie sa mus√≠≈° prihl√°si≈•.
        </p>
    {% endif %}

    <hr>

    <!-- UPRAVI≈§ PROJEKT ‚Äì LEN AUTOR -->
    {% if user.is_authenticated and user == project.author %}
        <a href="{% url 'project_edit' project.pk %}"
           class="btn btn-warning w-100 mb-2">
            Upravi≈• projekt
        </a>
    {% endif %}

    <!-- SP√Ñ≈§ -->
    <a href="{% url 'project_list' %}"
       class="btn btn-outline-secondary w-100">
        Sp√§≈• na projekty
    </a>

</div>

{% endblock %}
